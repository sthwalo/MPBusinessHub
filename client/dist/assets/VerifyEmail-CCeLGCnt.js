import{j as e}from"./index-BTjPMemu.js";import{r as n,h as p,u as v,L as h}from"./vendor-BMRKNa3Q.js";import{V as o}from"./ui-BuAqC3bd.js";import"./sentry-CdN5cWpD.js";function E(){const[t,s]=n.useState("loading"),[c,a]=n.useState(""),d=p(),i=v();return n.useEffect(()=>{(async()=>{try{const r=new URLSearchParams(d.search),l=r.get("id"),m=r.get("hash"),b=r.get("expires"),u=r.get("signature");if(!l||!m||!b||!u){s("error"),a("Invalid verification link");return}const x=await fetch(`/api/email/verify/${l}/${m}?expires=${b}&signature=${u}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}),g=await x.json();if(x.ok){s("success"),a(g.message||"Email verified successfully"),o.success("Email verified successfully");const f=localStorage.getItem("mpbh_token");setTimeout(f?()=>{i("/dashboard")}:()=>{i("/login")},3e3)}else s("error"),a(g.message||"Failed to verify email"),o.error("Failed to verify email")}catch(r){console.error("Verification error:",r),s("error"),a("An error occurred during verification"),o.error("An error occurred during verification")}})()},[d,i]),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-md mx-auto bg-brand-white rounded-lg shadow-md border border-brand-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Email Verification"}),t==="loading"&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-brand-black mb-4"}),e.jsx("p",{className:"text-brand-gray-600",children:"Verifying your email address..."})]}),t==="success"&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"bg-green-50 text-green-800 p-4 rounded-md mb-6",children:[e.jsx("p",{children:c}),e.jsx("p",{className:"mt-2",children:"You will be redirected shortly."})]}),e.jsx(h,{to:"/login",className:"inline-block px-4 py-2 bg-brand-black text-brand-white font-medium rounded hover:bg-brand-gray-800 transition-colors",children:"Go to Login"})]}),t==="error"&&e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"bg-red-50 text-red-800 p-4 rounded-md mb-6",children:[e.jsx("p",{children:c}),e.jsx("p",{className:"mt-2",children:"Please try again or request a new verification link."})]}),e.jsx(h,{to:"/login",className:"inline-block px-4 py-2 bg-brand-black text-brand-white font-medium rounded hover:bg-brand-gray-800 transition-colors mr-4",children:"Go to Login"}),e.jsx("button",{onClick:()=>i("/resend-verification"),className:"inline-block px-4 py-2 border border-brand-black text-brand-black font-medium rounded hover:bg-brand-gray-100 transition-colors",children:"Resend Verification"})]})]})})})}export{E as default};
