import{j as e}from"./index-BTjPMemu.js";import{r as n,L as x}from"./vendor-BMRKNa3Q.js";import{V as o}from"./ui-BuAqC3bd.js";import"./sentry-CdN5cWpD.js";function V(){const[t,f]=n.useState(""),[i,l]=n.useState({}),[d,c]=n.useState(!1),[u,p]=n.useState(!1),g=a=>{f(a.target.value),i.email&&l({})},y=()=>{const a={};return t?/\S+@\S+\.\S+/.test(t)||(a.email="Email is invalid"):a.email="Email is required",l(a),Object.keys(a).length===0},j=async a=>{if(a.preventDefault(),!!y()){c(!0);try{const r=o.loading("Sending verification email..."),m=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:t,password:""})});let s=null;m.ok&&(s=(await m.json()).data.token,localStorage.setItem("mpbh_token",s));const b={"Content-Type":"application/json",Accept:"application/json"};s&&(b.Authorization=`Bearer ${s}`);const h=await fetch("/api/email/verification-notification",{method:"POST",headers:b,body:JSON.stringify({email:t})});o.dismiss(r);const v=await h.json();if(h.ok)o.success("Verification email sent successfully"),p(!0);else throw new Error(v.message||"Failed to send verification email")}catch(r){console.error("Verification email error:",r),l({form:r.message||"Failed to send verification email. Please try again."}),o.error("Failed to send verification email")}finally{c(!1)}}};return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-md mx-auto bg-brand-white rounded-lg shadow-md border border-brand-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Resend Verification Email"}),u?e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"bg-green-50 text-green-800 p-4 rounded-md mb-6",children:[e.jsx("p",{children:"We've sent a verification email to your address."}),e.jsx("p",{className:"mt-2",children:"Please check your inbox and follow the instructions to verify your email."})]}),e.jsx(x,{to:"/login",className:"inline-block px-4 py-2 bg-brand-black text-brand-white font-medium rounded hover:bg-brand-gray-800 transition-colors",children:"Return to Login"})]}):e.jsxs(e.Fragment,{children:[i.form&&e.jsx("div",{className:"bg-red-50 text-red-800 p-4 rounded-md mb-6",children:i.form}),e.jsx("p",{className:"text-brand-gray-600 mb-6",children:"Enter your email address and we'll send you a verification email."}),e.jsxs("form",{onSubmit:j,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"email",className:"block text-brand-black font-medium mb-1",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",className:`w-full p-2 border ${i.email?"border-red-500":"border-brand-gray-300"} rounded focus:outline-none focus:ring-1 focus:ring-brand-black`,value:t,onChange:g,placeholder:"youremail@example.com"}),i.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.email})]}),e.jsx("button",{type:"submit",className:`px-4 py-2 bg-brand-black text-brand-white font-medium rounded hover:bg-brand-gray-800 transition-colors w-full ${d?"opacity-75":""}`,disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin inline-block h-5 w-5 mr-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending..."]}):"Send Verification Email"})]}),e.jsx("div",{className:"text-center mt-6",children:e.jsxs("p",{className:"text-brand-gray-600",children:["Already verified?"," ",e.jsx(x,{to:"/login",className:"text-brand-black hover:text-brand-gray-600 border-b border-brand-gray-400 font-medium",children:"Back to Login"})]})})]})]})})})}export{V as default};
